<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é³æ´‹ç§‘æŠ€ - 2026 è·¯è·‘æ´»å‹•å“¡å·¥å ±åç³»çµ±</title>
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: #f8f9fa; margin: 0; padding: 20px; display: flex; flex-direction: column; min-height: 100vh; }
        .container { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 600px; margin: auto; flex: 1; }
        .logo-container { text-align: center; margin-bottom: 25px; }
        .logo-placeholder { width: 220px; height: auto; }
        .banner-img { width: 100%; height: auto; border-radius: 8px; margin-bottom: 20px; border: 1px solid #eee; }
        h2 { text-align: center; color: #003366; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        h3 { color: #555; font-size: 16px; margin-top: 20px; border-left: 4px solid #003366; padding-left: 10px; }
        
        .official-notice { background-color: #fff9db; border: 1px solid #f59f00; padding: 15px; border-radius: 8px; margin-bottom: 25px; font-size: 14px; line-height: 1.6; color: #856404; }
        .official-notice b { color: #d9480f; }

        .info-card { background-color: #eef2f7; border-radius: 8px; padding: 15px; margin-bottom: 25px; border: 1px solid #d1d9e6; }
        .info-item { margin-bottom: 10px; font-size: 15px; color: #333; }
        .info-label { font-weight: bold; color: #003366; display: inline-block; width: 85px; }
        .schedule-table { width: 100%; border-collapse: collapse; margin-top: 10px; background: white; font-size: 13px; }
        .schedule-table th, .schedule-table td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        .schedule-table th { background-color: #003366; color: white; }
        
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #333; }
        .note { font-size: 13px; color: #d9534f; margin-bottom: 10px; font-weight: bold; line-height: 1.4; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 16px; }
        input[readonly] { background-color: #e9ecef; color: #6c757d; cursor: not-allowed; border: 1px solid #ddd; }
        .row { display: flex; gap: 10px; }
        .row .form-group { flex: 1; }
        button { width: 100%; padding: 15px; background-color: #003366; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 18px; margin-top: 20px; font-weight: bold; }
        button:hover { background-color: #002244; }
        .hidden { display: none !important; }
        footer { text-align: center; font-size: 12px; color: #999; margin-top: 30px; padding-bottom: 10px; }

        #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center; z-index: 999; }
        #agreementBox { background: white; width: 90%; max-width: 700px; max-height: 85vh; padding: 25px; border-radius: 10px; overflow-y: auto; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        #agreementBody { font-size: 14px; line-height: 1.8; color: #444; text-align: justify; background: #f9f9f9; padding: 15px; border: 1px solid #ddd; border-radius: 5px; white-space: pre-wrap; }
        .warning-title { color: #d9534f; font-weight: bold; margin-top: 15px; display: block; }

        /* æ„Ÿè¬é é¢æ¨£å¼ */
        #thankYouSection { text-align: center; padding: 40px 10px; }
        .thank-you-name { font-weight: bold; color: #003366; }
    </style>
</head>
<body>

<div id="overlay">
    <div id="agreementBox">
        <h2>æ´»å‹•åˆ‡çµæ›¸èˆ‡å…è²¬è²æ˜</h2>
        <div id="agreementBody"></div>
        <button type="button" onclick="acceptAgreement()">æˆ‘åŒæ„ä¸¦éµå®ˆä»¥ä¸Šäº‹é …</button>
    </div>
</div>

<div class="container">
    <div id="loginSection">
        <div class="logo-container">
            <img src="rapidtek_logo.png" alt="Rapidtek Logo" class="logo-placeholder">
        </div>
        <h2>å“¡å·¥ç™»å…¥é©—è­‰</h2>
        <div class="official-notice">
            æœ¬é é¢ç”±<b>é³æ´‹ç§‘æŠ€è·å·¥ç¦åˆ©å§”å“¡æœƒ</b>å»ºç½®ï¼Œæ—¨åœ¨å”åŠ©åŒä»çµ±ç±Œæ”¶é›†è³‡æ–™ä¸¦è¾¦ç†åœ˜é«”å ±åã€‚
            æœ¬æ´»å‹•ä¹‹æ­£å¼ç«¶è³½è¦ç¨‹ã€æ¬Šåˆ©ç¾©å‹™åŠåƒè³½è¦ç¯„ï¼Œæ‚‰ä»¥<b>ã€Œæ¨‚æ´»å ±åç¶²ã€</b>ä¸»è¾¦å–®ä½å…¬å‘Šç‚ºæº–ã€‚
        </div>
        <div class="form-group">
            <label>é›»å­ä¿¡ç®± (å…¬å¸ä¿¡ç®±)</label>
            <input type="email" id="loginEmail" placeholder="example@rapidtek.net">
        </div>
        <div class="form-group">
            <label>å“¡å·¥å·¥è™Ÿ</label>
            <input type="text" id="empID" placeholder="è«‹è¼¸å…¥å·¥è™Ÿ (å¦‚: RPxxxxx)">
        </div>
        <button type="button" onclick="showSurvey()">é©—è­‰ä¸¦é€²å…¥å ±åè¡¨å–®</button>
    </div>

    <form id="surveyForm" class="hidden">
        <div class="logo-container">
            <img src="rapidtek_logo.png" alt="Rapidtek Logo" class="logo-placeholder">
        </div>
        <img src="banner.png" alt="æ´»å‹•æ©«å¹…" class="banner-img">
        <h2>2026 é³æ´‹-è·¯è·‘æ´»å‹•å“¡å·¥å ±åè¡¨å–®</h2>
        
        <div class="official-notice">
            ğŸ“Œ <b>è£œåŠ©èªªæ˜ï¼š</b>æœ¬æ¬¡æ´»å‹•åƒ…é™<b>æ­£å¼å“¡å·¥</b>äº«æœ‰è·ç¦æœƒå…¨é¡è£œåŠ©ã€‚è‹¥å®¶å±¬æˆ–è¦ªå‹æ¬²é™ªåŒåƒåŠ ï¼Œè«‹é€•è‡ªå‰å¾€ <a href="https://lohasnet.tw/Technology2026/#activity" target="_blank">ä¸»è¾¦å–®ä½ç¶²ç«™</a> å–®ç¨å ±åã€‚
        </div>

        <div class="info-card">
            <h3>ğŸƒ è³½äº‹è³‡è¨Šæ‡¶äººåŒ…</h3>
            <div class="info-item"><span class="info-label">æ´»å‹•æ—¥æœŸï¼š</span>2026-04-19 (æ˜ŸæœŸæ—¥)</div>
            <div class="info-item"><span class="info-label">æ´»å‹•åœ°é»ï¼š</span>å°åŒ—å¸‚ä¸­å±±å€ç¾å ¤æ²³æ¿±å…¬åœ’ (16è™Ÿæ°´é–€é€²å…¥)</div>
            <div class="info-item"><span class="info-label">å»ºè­°æŠµé”ï¼š</span><b>05:30 - 06:00 (åƒåŠ è€…é›†åˆã€è¡£ç‰©å¯„æ”¾)</b></div>
            <div class="info-item"><span class="info-label">è©³æƒ…åƒè€ƒï¼š</span><a href="https://lohasnet.tw/Technology2026/#activity" target="_blank">æ¨‚æ´»å®˜æ–¹ç¶²ç«™æ´»å‹•ç°¡ç« </a></div>
            
            <table class="schedule-table">
                <thead>
                    <tr>
                        <th>çµ„åˆ¥</th>
                        <th>èµ·è·‘æ™‚é–“</th>
                        <th>é™åˆ¶æ™‚é–“</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>21å…¬é‡Œçµ„</td>
                        <td>06:45</td>
                        <td>3å°æ™‚30åˆ†</td>
                    </tr>
                    <tr>
                        <td>10å…¬é‡Œçµ„</td>
                        <td>07:00</td>
                        <td>2å°æ™‚</td>
                    </tr>
                    <tr>
                        <td>5å…¬é‡Œçµ„</td>
                        <td>07:15</td>
                        <td>1å°æ™‚30åˆ†</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h3>ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºæœ¬è³‡æ–™</h3>
        <div class="form-group">
            <label>åœ˜å“¡å§“å (è‡ªå‹•å¸¶å…¥)</label>
            <input type="text" name="name" id="userName" readonly required>
        </div>
        <div class="row">
            <div class="form-group">
                <label>åœ˜å“¡èº«åˆ†è­‰å­—è™Ÿ</label>
                <input type="text" name="idNum" required>
            </div>
            <div class="form-group">
                <label>åœ˜å“¡æ€§åˆ¥</label>
                <select name="gender" required>
                    <option value="ç”·">ç”·</option>
                    <option value="å¥³">å¥³</option>
                </select>
            </div>
        </div>
        <div class="row">
            <div class="form-group">
                <label>åœ˜å“¡ç”Ÿæ—¥</label>
                <input type="date" name="birthday" required>
            </div>
            <div class="form-group">
                <label>è¡Œå‹•é›»è©±</label>
                <input type="tel" name="phone" required placeholder="09xxxxxxxx">
            </div>
        </div>

        <h3>ç¬¬äºŒéƒ¨åˆ†ï¼šç·Šæ€¥è¯çµ¡è³‡è¨Š</h3>
        <div class="note">â€» ç·Šæ€¥è¯çµ¡äººè«‹å‹¿å¡«å¯«åƒåŠ äººå“¡ï¼Œä»¥å…æ´»å‹•ä¸­å»¶èª¤ç·Šæ€¥è¯çµ¡è™•ç½®</div>
        <div class="row">
            <div class="form-group">
                <label>ç·Šæ€¥è¯çµ¡äººå§“å</label>
                <input type="text" name="emergencyName" required>
            </div>
            <div class="form-group">
                <label>ç·Šæ€¥è¯çµ¡äººé—œä¿‚</label>
                <input type="text" name="emergencyRelation" required placeholder="å¦‚ï¼šçˆ¶å­ã€é…å¶">
            </div>
        </div>
        <div class="form-group">
            <label>ç·Šæ€¥è¯çµ¡äººé›»è©±</label>
            <input type="tel" name="emergencyPhone" required placeholder="09xxxxxxxx">
        </div>

        <h3>ç¬¬ä¸‰éƒ¨åˆ†ï¼šç™¼ç¥¨è³‡è¨Š (è·ç¦æœƒçµ±ä¸€å°å¤–)</h3>
        <div class="form-group">
            <label>ç™¼ç¥¨é¡å‹ (å·²é–å®š)</label>
            <input type="text" name="invoiceType" value="å…¬å¸å ±å¸³(ä¸‰è¯å¼)" readonly>
        </div>
        <div class="row">
            <div class="form-group">
                <label>æŠ¬é ­ (å·²é–å®š)</label>
                <input type="text" name="invoiceTitle" value="é³æ´‹ç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸è·å·¥ç¦åˆ©å§”å“¡æœƒ" readonly>
            </div>
            <div class="form-group">
                <label>çµ±ä¸€ç·¨è™Ÿ (å·²é–å®š)</label>
                <input type="text" name="taxId" value="91616791" readonly>
            </div>
        </div>

        <h3>ç¬¬å››éƒ¨åˆ†ï¼šé …ç›®é¸å¡«</h3>
        <div class="form-group">
            <label>ç«¶è³½é …ç›®</label>
            <select name="category" required>
                <option value="21å…¬é‡Œçµ„">21å…¬é‡Œçµ„</option>
                <option value="10å…¬é‡Œçµ„">10å…¬é‡Œçµ„</option>
                <option value="5å…¬é‡Œçµ„">5å…¬é‡Œçµ„</option>
            </select>
        </div>
        <div class="form-group">
            <label>å¥½ç¦®äºŒé¸ä¸€</label>
            <select name="gift" required>
                <option value="Panasonicæœæ±æ©Ÿ">Panasonicæœæ±æ©Ÿ</option>
                <option value="Panasonicæ›ç‡™æ©Ÿ">Panasonicæ›ç‡™æ©Ÿ</option>
            </select>
        </div>
        <div class="form-group">
            <label>ç´€å¿µé‹å‹•è¡£ (å°ºå¯¸)</label>
            <select name="tshirt" required>
                <option value="ç´€å¿µé‹å‹•è¡£(XXS)">XXS</option>
                <option value="ç´€å¿µé‹å‹•è¡£(XS)">XS</option>
                <option value="ç´€å¿µé‹å‹•è¡£(S)">S</option>
                <option value="ç´€å¿µé‹å‹•è¡£(M)">M</option>
                <option value="ç´€å¿µé‹å‹•è¡£(L)">L</option>
                <option value="ç´€å¿µé‹å‹•è¡£(XL)">XL</option>
                <option value="ç´€å¿µé‹å‹•è¡£(XXL)">XXL</option>
            </select>
        </div>

        <button type="submit" id="submitBtn">ç¢ºèªæäº¤å ±åè³‡æ–™</button>
    </form>

    <div id="thankYouSection" class="hidden">
        <div class="logo-container">
            <img src="rapidtek_logo.png" alt="Rapidtek Logo" class="logo-placeholder">
        </div>
        <h2 style="color: #003366; margin-top: 30px;">å ±åæˆåŠŸ</h2>
        <p style="font-size: 18px; line-height: 1.8; color: #333;">
            é³æ´‹ç¦å§”æ„Ÿè¬ <span id="displayUserName" class="thank-you-name"></span> å ±ååƒåŠ æ­¤æ´»å‹•ã€‚
        </p>
        <p style="color: #666; font-size: 14px; margin-bottom: 30px;">æ‚¨çš„è³‡æ–™å·²æˆåŠŸå‚³é€ï¼Œè«‹ç•™æ„å¾ŒçºŒç›¸é—œé€šçŸ¥ã€‚</p>
        <button type="button" onclick="location.reload()" style="max-width: 200px; margin: 0 auto;">è¿”å›é¦–é </button>
    </div>
</div>

<footer>
    æœ¬ç³»çµ±åƒ…ä¾›å…§éƒ¨è³‡æ–™æ”¶é›†ä½¿ç”¨ | ç›¸é—œè³½äº‹è¦ç¨‹ä¾ç…§ <a href="https://lohasnet.tw/Technology2026/#activity" target="_blank">ä¸»è¾¦å–®ä½å®˜ç¶²</a> ç‚ºæº–ã€‚<br>
    Rapidtek Technologies Inc. Â© 2025 All Rights Reserved.
</footer>

<script>
    // å“¡å·¥ç™½åå–®
    var employeeWhitelist = [
        {id: "RP06001", name: "ç‹å¥•ç¿” Arthur", email: "arthur@rapidtek.net"},
        {id: "RP10002", name: "å¼µæ„› Vivian", email: "accountant@rapidtek.net"},
        {id: "RP21021", name: "è”¡ä½³å€« Carol", email: "carol.tsai@rapidtek.net"},
        {id: "RP20004", name: "èƒ¡æ–‡ä¿® Matthew", email: "matthew.hu@rapidtek.net"},
        {id: "RP16003", name: "è³´æ€¡é›¯ Winny", email: "winny.lai@rapidtek.net"},
        {id: "RP21020", name: "è‘‰è‰æ¶µ Vicky", email: "vicky.yeh@rapidtek.net"},
        {id: "RP24005", name: "æ—äº­å‡ Celia", email: "pr@rapidtek.net"},
        {id: "RP25004", name: "æ¥Šæ…§æ–‡ Vera", email: "vera.yong@rapidtek.net"},
        {id: "RP25011", name: "è˜‡ç²éƒ Lilyah", email: "lilyah.su@rapidtek.net"},
        {id: "RP22030", name: "æ—æ…§ Dora", email: "dora.lin@rapidtek.net"},
        {id: "RP25006", name: "è”¡é–æ™¨ Ansley", email: "ansley.tsai@rapidtek.net"},
        {id: "RP24038", name: "è©¹èŠ³ç‘œ Fallon", email: "fallon.jan@rapidtek.net"},
        {id: "RP25007", name: "éƒ­ç´˜å¿— Jimmy", email: "jimmy.kuo@rapidtek.net"},
        {id: "RP25009", name: "æå²³éœ– Melo", email: "melo.lee@rapidtek.net"},
        {id: "RP25012", name: "æ—æ¥šç‘„ Molly", email: "molly.lin@rapidtek.net"},
        {id: "RP25016", name: "ç‹å¥‡éœ– Kirin", email: "kirin.wang@rapidtek.net"},
        {id: "RP25013", name: "é»ƒæ©ä½‘ Alex", email: "alex.huang@rapidtek.net"},
        {id: "RP23027", name: "é„­ç§€æ¢“ Elly", email: "elly.zheng@rapidtek.net"},
        {id: "RP24028", name: "éƒ­å„€å› Yarissa", email: "varissa.kuo@rapidtek.net"},
        {id: "RP18014", name: "è©¹äººéœ Zoe", email: "zoe.chan@rapidtek.net"},
        {id: "RP20005", name: "é™³è§€è±ª Kody", email: "mis@rapidtek.net"},
        {id: "RP24003", name: "é™³ç´”é›… Lucy", email: "lucy.chen@rapidtek.net"},
        {id: "RP21004", name: "é„­ç‰ Prince", emails: ["prince.jeng@rapidtek.net", "prince.jenq@rapidtek.net"]},
        {id: "RP24017", name: "å»–äº Ruru", email: "ruru.liao@rapidtek.net"},
        {id: "RP23042", name: "æ¸¸æ–‡è¯ Robert", email: "robert.yu@rapidtek.net"},
        {id: "RP06002", name: "æå­Ÿæ…ˆ Claire", email: "claire@rapidtek.net"},
        {id: "RP18020", name: "å½­ä¿Šå‡± Kai", email: "kai.peng@rapidtek.net"},
        {id: "RP23003", name: "æœ±è‰¯ Ryan", email: "ryan.ju@rapidtek.net"},
        {id: "RP10001", name: "æ¢è™¹ May", email: "may_l@rapidtek.net"},
        {id: "RP20001", name: "ç‹é½¡ Ling", email: "ling.wang@rapidtek.net"},
        {id: "RP18009", name: "æå† è³¢ Sean", email: "sean.lee@rapidtek.net"},
        {id: "RP24030", name: "æ—æŸå· Frank", email: "frank.lin@rapidtek.net"},
        {id: "RP25020", name: "è©¹è©  Daphne", email: "daphne.chan@rapidtek.net"},
        {id: "RP23005", name: "æ—è‡´å® Ben", email: "ben.lin@rapidtek.net"},
        {id: "RP25018", name: "é™³è–æ¨º Levi", email: "levi.chen@rapidtek.net"},
        {id: "RP25019", name: "éƒ­æ–¼è± Beryl", email: "beryl.kuo@rapidtek.net"},
        {id: "RP23033", name: "è”£æ™ºä¸­ Alex", email: "alex.chiang@rapidtek.net"},
        {id: "RP21018", name: "è¨±åŠ­è–‡ Kate", email: "kate.hsu@rapidtek.net"},
        {id: "RP24023", name: "å³å¥•è”µ Wes", email: "wes.wu@rapidtek.net"},
        {id: "RP24025", name: "è¨±åº­ç‘œ Winnie", email: "winnie.hsu@rapidtek.net"},
        {id: "RP25014", name: "å»–å©•å¦¤ Ruby", email: "ruby.liao@rapidtek.net"},
        {id: "RPC21801", name: "éŒ¢ç«‹å®¶ Eric", email: "eric.qian@rapidtek.net"},
        {id: "RPC21802", name: "è˜‡éœˆå¾· Peido", email: "peido.su@rapidtek.net"},
        {id: "RP24027", name: "éƒ­è‡´å® Bryant", email: "bryant.kuo@rapidtek.net"},
        {id: "RP24029", name: "ææŸ”æ–½ Silvia", email: "silvia.lee@rapidtek.net"},
        {id: "RP24007", name: "æ—å“²æ¯… Joey", email: "joey.lin@rapidtek.net"},
        {id: "RP25008", name: "é™³æ¸¸å‹• Jimmy", email: "jimmy.chen@rapidtek.net"},
        {id: "RP25021", name: "è–›éƒæ¨º Louis", email: "louis.hsueh@rapidtek.net"},
        {id: "RP17609", name: "é™³å­Ÿæš Jason", email: "jason.chen@rapidtek.net"},
        {id: "RP24034", name: "è˜‡æŸå¦® Bernice", email: "bernice.su@rapidtek.net"},
        {id: "RP25005", name: "é™³é–ç‘‹ Jerry", email: "jerry.chen@rapidtek.net"},
        {id: "RP25017", name: "é™³å®—ä½‘ Jack", email: "jack.chen@rapidtek.net"},
        {id: "RP22013", name: "ç™½åœ‹å¨ Kuowei", email: "kuowei.pai@rapidtek.net"},
        {id: "RP24032", name: "ç‹è‡£æœ¨ CM", email: "cm.wang@rapidtek.net"},
        {id: "RP23024", name: "ææ—»å“² Vincent", email: "vincent.lee@rapidtek.net"},
        {id: "RP24036", name: "é™³ Eddie", email: "eddie.chen@rapidtek.net"},
        {id: "RP17014", name: "å¼µå»·è€€ Ice", email: "ice.chang@rapidtek.net"},
        {id: "RP24001", name: "åŠ‰é•·å‹• Ken", email: "ken.liu@rapidtek.net"},
        {id: "RP24021", name: "è¢ç™»å‘¨ Frank", email: "frank.vuan@rapidtek.net"},
        {id: "RP17001", name: "å¾ç‘‹æš Wade", email: "wade.hsu@rapidtek.net"},
        {id: "RP24008", name: "æ—æ™‰ä¸ Chris", email: "chris.lin@rapidtek.net"},
        {id: "RP25015", name: "è‘‰æ¾ Ken", email: "ken.yeh@rapidtek.net"},
        {id: "RP23031", name: "ææ–‡åŸº Vincent", email: "vincentleel@rapidtek.net"},
        {id: "RP18611", name: "è³´ç´ å¦‚ Ruru", email: "ruru.lai@rapidtek.net"},
        {id: "RP21605", name: "å®‹æ—»æ½” Stacey", email: "stacey.song@rapidtek.net"},
        {id: "RP24022", name: "è¨±éŠ˜ Henry", email: "henry.hsu@rapidtek.net"},
        {id: "RP18604", name: "å³æ¾å“² Andy", email: "andy.wu@rapidtek.net"},
        {id: "RP24024", name: "è£œæ–‡å½¬ Rex", email: "rex.chu@rapidtek.net"},
        {id: "RP25010", name: "æ¥Šè£•ä» Edward", email: "edward.yang@rapidtek.net"},
        {id: "RP14601", name: "è˜‡è‚²ç«‹ Ali", email: "rapidtek.ali@gmail.com"},
        {id: "RP25003", name: "æ›¾è–‡ Vivian", email: "vivian.tseng@rapidtek.net"},
        {id: "RP18028", name: "æ—å®¶å®‰ Miko", email: "miko.lin@rapidtek.net"},
        {id: "RP21012", name: "é»ƒè©© Dianne", email: "dianne.huang@rapidtek.net"},
        {id: "RP23037", name: "è¨±åº­ç‘„ Elsa", email: "elsa.hsu@rapidtek.net"},
        {id: "RP21609", name: "é™³èŠ³æ¬£ Cathy", email: "cathy.chen@rapidtek.net"},
        {id: "RP24026", name: "é»ƒæ˜­å®¹ Fiona", email: "fiona.huang@rapidtek.net"}
    ];

    var agreementData = {
        "content": "ã€é‡è¦è²æ˜ã€‘æœ¬ç¶²é åƒ…ä½œç‚ºé³æ´‹ç§‘æŠ€å…§éƒ¨å“¡å·¥è·¯è·‘æ´»å‹•å ±åè³‡æ–™æ”¶é›†ä¹‹ç”¨ã€‚æ‰€æœ‰åƒè³½è¦ç¯„ã€ä¿éšªè²¬ä»»åŠè³½äº‹æ¬Šåˆ©å‡ä»¥ã€Œæ¨‚æ´»å ±åç¶²ã€ä¸»è¾¦å–®ä½å…¬å‘Šä¹‹æ­£å¼è¦ç¨‹ç‚ºæœ€é«˜æº–å‰‡ã€‚ä¸€æ—¦å®Œæˆæäº¤ï¼Œå³ä»£è¡¨æ‚¨åŒæ„ä»¥ä¸‹åˆ‡çµäº‹é …ï¼š\n\næœ¬äººå·²è©³ç´°é–±è®€éæœ¬æ´»å‹•ä¹‹ç«¶è³½è¦ç¨‹ä¸”åŒæ„äº¦ä¿è­‰éµå®ˆå¤§æœƒæ–¼ç«¶è³½è¦ç¨‹ä¸­æ‰€ç´„å®šä¹‹äº‹é …ï¼Œä¿è­‰æœ¬äººèº«å¿ƒå¥åº·ï¼Œäº¦äº†è§£é¦¬æ‹‰æ¾/è·¯è·‘æ¯”è³½æ‰€éœ€æ‰¿å—ä¹‹é¢¨éšªï¼Œè‡ªé¡˜åƒåŠ æ¯”è³½ã€‚ç«¶è³½ä¸­è‹¥ç™¼ç”Ÿä»»ä½•æ„å¤–äº‹ä»¶ï¼Œæœ¬äººåŠå®¶å±¬é¡˜æ„æ‰¿æ“”æ¯”è³½æœŸé–“æ‰€ç™¼ç”Ÿä¹‹å€‹äººæ„å¤–é¢¨éšªè²¬ä»»ï¼Œèˆ‡ä»£è¾¦å–®ä½ï¼ˆé³æ´‹ç§‘æŠ€è·ç¦æœƒï¼‰åŠä¸»è¾¦å–®ä½ç„¡æ¶‰ã€‚äº¦æ˜ç™½æ­¤é …æ¯”è³½çš„éŒ„å½±ã€ç›¸ç‰‡ã€å§“ååŠæˆç¸¾å¯èƒ½æ–¼ä¸–ç•Œå„åœ°æ’­æ”¾æˆ–å±•å‡ºã€‚æœ¬äººä¿è­‰æä¾›æœ‰æ•ˆçš„èº«ä»½è­‰å’Œè³‡æ–™ç”¨æ–¼æ ¸å¯¦èº«ä»½ã€‚ä¸€ç¶“æäº¤ï¼Œä¸å¾—ä»¥ä»»ä½•ç†ç”±è¦æ±‚æ›´æ›äººåã€åƒè³½é …ç›®æˆ–è¡£æœå°ºå¯¸ã€‚åš´ç¦é™ªè·‘ã€‚",
        "notes": [
            "1. æœ¬å ±åç³»çµ±åƒ…ä¾›é³æ´‹ç§‘æŠ€ã€Œæ­£å¼åŒä»ã€ä½¿ç”¨ï¼Œç”±è·ç¦æœƒè£œåŠ©å…¨é¡å ±åè²»ã€‚",
            "2. åŒä»å®¶å±¬å¦‚æ¬²åƒè³½ï¼Œè«‹è‡ªè¡Œå‰å¾€ä¸»è¾¦å–®ä½å®˜ç¶²å ±åï¼Œä¸ç´å…¥æœ¬æ¬¡å…¬å¸åœ˜å ±è£œåŠ©ç¯„åœã€‚",
            "3. å ±åè³‡æ–™æäº¤å¾Œå°‡ç”±è·ç¦æœƒçµ±ä¸€å°å¤–åŒ¯å…¥ä¸»è¾¦å–®ä½ç³»çµ±ï¼Œè³‡æ–™å‹™å¿…å¡«å¯«æ­£ç¢ºã€‚"
        ]
    };

    window.onload = function() {
        var body = document.getElementById('agreementBody');
        var html = agreementData.content + "\n\n<span class='warning-title'>æ³¨æ„äº‹é …ï¼š</span>\n";
        agreementData.notes.forEach(function(n) { html += n + "<br>"; });
        body.innerHTML = html;
    };

    function acceptAgreement() { document.getElementById('overlay').style.display = 'none'; }

    function showSurvey() {
        var inputEmail = document.getElementById('loginEmail').value.trim().toLowerCase();
        var inputID = document.getElementById('empID').value.trim().toUpperCase();
        var user = employeeWhitelist.find(function(emp) {
            if (emp.id === inputID) {
                if (emp.emails) return emp.emails.some(e => e.toLowerCase() === inputEmail);
                return emp.email.toLowerCase() === inputEmail;
            }
            return false;
        });

        if (user) {
            document.getElementById('userName').value = user.name;
            document.getElementById('loginSection').classList.add('hidden');
            document.getElementById('surveyForm').classList.remove('hidden');
            window.scrollTo(0, 0);
        } else {
            alert('é©—è­‰å¤±æ•—ï¼šæ‚¨ä¸åœ¨åå–®å…§æˆ–è¼¸å…¥è³‡æ–™éŒ¯èª¤ã€‚æœ¬ç³»çµ±åƒ…é™é³æ´‹æ­£å¼åŒä»ç™»å…¥ã€‚');
        }
    }

    var scriptURL = 'https://script.google.com/macros/s/AKfycbwvB04SsgwpY3JnbJKui5J3Y1d2YxIoCj_sC_5fHlQfQ5_pIpdfmQd-jcKrK_FBPEQb/exec';
    var form = document.getElementById('surveyForm');

    form.addEventListener('submit', function(e) {
        e.preventDefault();
        var submitBtn = document.getElementById('submitBtn');
        var userName = document.getElementById('userName').value; // å–å¾—å“¡å·¥å§“å
        
        submitBtn.disabled = true;
        submitBtn.innerText = 'è³‡æ–™å‚³é€ä¸­...';

        var formData = new FormData(form);
        formData.append('email', document.getElementById('loginEmail').value);
        formData.append('empID', document.getElementById('empID').value);

        fetch(scriptURL, { method: 'POST', body: formData, mode: 'no-cors' })
        .then(function() {
            // éš±è—è¡¨å–®
            document.getElementById('surveyForm').classList.add('hidden');
            // è¨­å®šæ„Ÿè¬é é¢å§“å
            document.getElementById('displayUserName').innerText = userName;
            // é¡¯ç¤ºæ„Ÿè¬é é¢
            document.getElementById('thankYouSection').classList.remove('hidden');
            window.scrollTo(0, 0);
        })
        .catch(function() {
            alert('ç¶²è·¯ç•°å¸¸ï¼Œè«‹ç¨å¾Œå†è©¦');
            submitBtn.disabled = false;
            submitBtn.innerText = 'ç¢ºèªæäº¤å ±åè³‡æ–™';
        });
    });
</script>

</body>
</html>
